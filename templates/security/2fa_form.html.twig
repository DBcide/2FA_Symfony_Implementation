{# templates/security/2fa_form.html.twig #}
{% extends 'base.html.twig' %}

{% block title %}Deuxième facteur d’authentification{% endblock %}

{% block body %}
    <div class="d-flex align-items-center justify-content-center min-vh-100 bg-light">
        <div class="card shadow-sm" style="max-width: 500px; width: 100%;">
            <div class="card-body p-4">

                <h2 class="h4 fw-bold text-center mb-4">
                    {{ "auth_code"|trans({}, 'SchebTwoFactorBundle') }}
                </h2>

                {# Authentication errors #}
                {% if authenticationError %}
                    <div class="alert alert-danger small">
                        {{ authenticationError|trans(authenticationErrorData, 'SchebTwoFactorBundle') }}
                    </div>
                {% endif %}

                {# Let the user select the authentication method #}
                {% if availableTwoFactorProviders|length > 1 %}
                    <div class="mb-3 text-muted small">
                        {{ "choose_provider"|trans({}, 'SchebTwoFactorBundle') }} :
                        {% for provider in availableTwoFactorProviders %}
                            <a class="ms-2 link-primary"
                               href="{{ path("2fa_login", {"preferProvider": provider}) }}">
                                {{ provider }}
                            </a>
                        {% endfor %}
                    </div>
                {% endif %}

                <form action="{{ checkPathUrl ? checkPathUrl : path(checkPathRoute) }}" method="post">
                    <div class="mb-3">
                        <label for="_auth_code" class="form-label">
                            {{ "auth_code"|trans({}, 'SchebTwoFactorBundle') }} {{ twoFactorProvider }} :
                        </label>
                        <input
                            id="_auth_code"
                            type="text"
                            name="{{ authCodeParameterName }}"
                            autocomplete="one-time-code"
                            autofocus
                            inputmode="numeric"
                            pattern="[0-9]*"
                            class="form-control"
                        />
                    </div>

                    {% if displayTrustedOption %}
                        <div class="form-check mb-3">
                            <input id="_trusted"
                                   type="checkbox"
                                   name="{{ trustedParameterName }}"
                                   class="form-check-input">
                            <label for="_trusted" class="form-check-label">
                                {{ "trusted"|trans({}, 'SchebTwoFactorBundle') }}
                            </label>
                        </div>
                    {% endif %}

                    {% if isCsrfProtectionEnabled %}
                        <input type="hidden" name="{{ csrfParameterName }}" value="{{ csrf_token(csrfTokenId) }}">
                    {% endif %}

                    <div class="d-grid mb-3">
                        <button type="submit" class="btn btn-primary">
                            {{ "login"|trans({}, 'SchebTwoFactorBundle') }}
                        </button>
                    </div>
                </form>

                <div class="text-center mt-3">
                    <a href="{{ logoutPath }}" class="text-muted small">
                        {{ "cancel"|trans({}, 'SchebTwoFactorBundle') }}
                    </a>
                </div>
            </div>
        </div>
    </div>
{% endblock %}
